# 중앙처리장치(CPU) 작동 원리

> CPU는 컴퓨터에서 가장 핵심적인 역할을 담당하며 크게 **연산장치**, **제어장치**, **레지스터** 3가지로 구성된다.

```ABAP
📌 연산장치
- 산술연산과 논리연산 수행 (산술논리연산장치 ALU 라고도 불림)
- 연산에 필요한 데이터를 레지스터에서 가져오고, 연산 결과를 레지스터로 보냄

📌 제어장치
- 명령어를 순서대로 시리행할 수 있도록 제어
- 주기억장치에서 프로그램 명령어를 꺼내 해독한다.
- 해독한 결과에 따라 명령어 실행에 필요한 제어 신호를 기억장치, 연산장치, 입출력 장치로 보낸다.
- 이 장치들이 보낸 신호를 받아서 다음에 수행할 동작을 결정

📌 레지스터
- 고속 기억장치
- 명렁어 주소, 코드, 연산에 필요한 데이터, 연산 결과 등을 임시로 저장
- CPU 종류에 따라 사용할 수 있는 레지스터 개수와 크기가 다름
- 용도에 따라 범용 레지스터와 특수목적 레지스터로 구분
  - 범용 레지스터: 연산에 필요한 데이터나 연산 결과를 임시로 저장
  - 특수목적 레지스터: 특별한 용도로 사용하는 레지스터
    > MAR(메모리 주소 레지스터): 읽기와 쓰기 연산을 수행할 주기억장치 주소 저장
    > PC(프로그램 카운터): 다음에 수행할 명령어 주소 저장
    > IR(명령어 레지스터): 현재 실행 중인 명령어 저장
    > MBR(메모리 버퍼 레지스터): 주기억장치에서 읽어온 데이터 or 저장할 데이터 임시 저장
    > AC(누산기): 연산 결과 임시 저장
```

### CPU의 동작 과정

1. 주기억장치는 입력장치에서 입력받은 데이터 or 보조기억장치에 저장된 프로그램을 읽어옴
2. CPU는 프로그램을 실행하기 위해 주기억장치에 저장된 프로그램 명령어와 데이터를 읽어와 처리하고, 결과를 다시 주기억장치에 저장
3. 주기억장치는 처리 결과를 보조기억장치에 저장하거나 출력장치로 보냄
4. 제어장치는 1~3 과정에서 명령어가 순서대로 실행되도록 각 장치를 제어

```ABAP
❓ 명령어 세트 ❓
- CPU가 실행할 명령어의 집합

- 구성요소
  - 연산코드(Operation Code): 연산, 제어, 데이터 전달, 입출력 기능을 가짐
  - 피연산자(Operand): 주소, 숫자/문자, 논리 데이터 등을 저장

- CPU는 프로그램을 실행하기 위해 주기억장치에서 명령어를 순차적으로 인출하여 해독하고 실행하는 과정 반복
```

```ABAP
📌 명령어 사이클 📌
- CPU가 주기억장치에서 한번에 하나의 명령어를 인출하여 실행하는데 필요한 일련의 활동
- 인출 / 실행 / 간접 / 인터럽트 사이클로 나누어짐
- 주기억장치의 지정된 주소에서 하나의 명령어를 가져옴, 명렁어 실행, 하나의 명령어 실행이 완료되면 다음 명령어에 대한 인출 사이클 시작

---

🔄 인출 사이클과 실행 사이클에 의한 명령어 처리 과정 🔄
(인출 사이클에서 가장 중요한 부분은 PC 값 증가!)
1. PC에 저장된 주소를 MAR로 전달
2. 저장된 내용을 토대로 주기억장치의 해당 주소에서 명령어 인출
3. 인출한 명령어를 MBR에 저장
4. 다음 명령어 인출을 위해 PC 값 증가
5. MBR에 저장된 내용을 IR에 전달

$ T0: MAR ← PC
$ T1: MBR ← M[MAR], PC ← PC+1
$ T2: IR ← MBR

---

🔄 인출 이후, 명령어를 실행하는 과정 🔄
(ADD addr 명령어 연산)

1. 이미 인출이 진행되고 명령어만 실행하면 되기때문에 PC 증가 X
2. IR에 MBR의 값이 이미 저장된 상태를 의미
3. 따라서 AC에 MBR을 더해주기만 하면 된다

$ T0: MAR ← IR(Addr)
$ T1: MBR ← M[MAR]
$ T2: AC ← AC + MBR
```

### 질문

1. CPU가 명령어를 실행하기까지의 과정을 단계별로 설명해주세요.

```ABAP
1. PC의 주소를 MAR에 전달
2. 해당 명령어를 메모리에서 읽어 MBR에 저장
3. IR로 이동해 명령어 해석
4. 제어장치가 실행 지시
5. ALU가 연산 수행
6. PC 증가
7. 다음 명령어 처리
```

2. 레지스터 중 MAR, PC, IR, MBR, AC의 역할은 무엇이며, 이들이 어떻게 협력하는지 설명해주세요.

```ABAP
아래의 레지스터들은 명령어 처리 흐름에 따라 순차적으로 협력합니다
- PC: 다음 명령어 주소 저장
- MAR: 주소 전달
- MBR: 데이터 임시 저장
- IR: 명령어 저장 및 해석
- AC: 연산 결과 저장
```

3. 제어장치와 연산장치는 CPU 내에서 각각 어떤 역할을 하며, 명령어 실행 시 이 둘은 어떻게 협력하나요?

```ABAP
제어장치는 명령어 해석과 제어 신호 발생을 맡고,
연산장치는 실제 연산(더하기, 비교 등)을 담당합니다.
제어장치가 지시하고, ALU가 실행하며, 레지스터를 통해 서로 연계됩니다.
```
